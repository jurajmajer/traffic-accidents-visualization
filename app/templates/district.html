{% extends "base.html" %}

{% block head %}
	<script>
        
		function refreshAll()
		{
			refresh("/api/map/choropleth_district", "choropleth_map")
			refresh("/api/figure/total_accidents_by_district", "plot1")
		}
		
		$(function() {
		
			var choroplethDiv = document.getElementById('choropleth_map')
			choroplethDiv.on('plotly_click', function(data){
				if(data.points.length > 0)
				{
					var url = "/district_detail/" + data.points[0].properties.IDN3
					window.location.href = url
				}
			});
			
			var plotDiv = document.getElementById('plot1')
			plotDiv.on('plotly_click', function(data){
				if(data.points.length > 0)
				{
					var url = "/district_detail/" + data.points[0].customdata[0]
					window.location.href = url
				}
			});
		});
	
	</script>
{% endblock %}

{% block content %}
    <div id="choropleth_map" style="height:600px;" class="figure-general">
		<script>
		  var data = {{choropleth_map}};
		  Plotly.plot('choropleth_map', data, {});
		</script>
	</div>
	
	<div id="plot1"  class="figure-general">
		<script>
		  var graphs = {{plot1}};
		  Plotly.plot('plot1', graphs, {});
		</script>
	</div>
{% endblock %}